webpackJsonp([3],{"20zV":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".top_area[data-v-08dca417] {\n  font-size: 16px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-left: 24px;\n  color: #363c46;\n}\n.main_area[data-v-08dca417] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  margin-left: 24px;\n}\n.main_area .nameColumn[data-v-08dca417] {\n    margin-top: 16px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.main_area .descColumn[data-v-08dca417] {\n    margin-top: 16px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.main_area .fileColumn[data-v-08dca417] {\n    margin-top: 16px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.main_area .fileNameColumn[data-v-08dca417] {\n    margin-top: 5px;\n    margin-left: 70px;\n    width: 250px;\n    padding-left: 10px;\n    height: 22px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    font-size: 12px;\n    background-color: #f4f5f6;\n}\n.bottom_area[data-v-08dca417] {\n  width: 100%;\n  padding-right: 24px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: end;\n      -ms-flex-pack: end;\n          justify-content: flex-end;\n}\n",""])},"3Khx":function(e,t,a){"use strict";var n=a("tgZC");a.n(n).a},"6Azs":function(e,t,a){var n=a("B6kk");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("2b4fbe1e",n,!0)},"6F1D":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".appendLayout[data-v-7fd41c9d] {\n  padding: 10px 0px 20px 0px;\n  height: 100%;\n  width: 100%;\n}\n",""])},B6kk:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".top_area[data-v-cbaa47ba] {\n  font-size: 16px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-left: 24px;\n  color: #363c46;\n}\n.main_area[data-v-cbaa47ba] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-top: 41px;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.main_area .title1[data-v-cbaa47ba] {\n    font-size: 20px;\n    margin-top: 24px;\n    height: 32px;\n}\n.main_area .title2[data-v-cbaa47ba] {\n    font-size: 14px;\n    height: 32px;\n    margin-top: 5px;\n}\n.bottom_area[data-v-cbaa47ba] {\n  width: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  margin-top: -60px;\n}\n.bottom_area .btn_wait_permission[data-v-cbaa47ba] {\n    margin-right: 50px;\n}\n",""])},BDhp:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".versionBasicInfoLayout[data-v-fc2745ee] {\n  height: 100%;\n  width: 1200px;\n  margin: 20px 35px 20px 24px;\n}\n.versionBasicInfoLayout .outer_version_content[data-v-fc2745ee] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.versionBasicInfoLayout .inner_version_content[data-v-fc2745ee] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    margin-top: 24px;\n}\n.versionBasicInfoLayout .user_guide_content[data-v-fc2745ee] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: start;\n        -ms-flex-align: start;\n            align-items: flex-start;\n    margin-top: 24px;\n}\n.versionBasicInfoLayout .markdownPad[data-v-fc2745ee] {\n    height: 500px;\n    width: 1200px;\n}\n.versionBasicInfoLayout .button_area[data-v-fc2745ee] {\n    width: 100%;\n    margin-top: 43px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: end;\n        -ms-flex-pack: end;\n            justify-content: flex-end;\n}\n",""])},Gww1:function(e,t,a){var n=a("20zV");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("a90f92b2",n,!0)},"V8/E":function(e,t,a){"use strict";var n=a("Gww1");a.n(n).a},"W4/O":function(e,t,a){var n=a("6F1D");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("1021444b",n,!0)},WiDU:function(e,t,a){"use strict";var n=a("W4/O");a.n(n).a},ftnC:function(e,t,a){"use strict";var n=a("sriz");a.n(n).a},s9Il:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),i=a.n(n),l=a("exGp"),s=a.n(l),r=a("B6Jl"),o=a("0jG4"),c=a("ilaD"),u=a("zL8q"),d=a("IaYK"),p={props:{productId:{},releaseId:{},isAdd:{}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},options1:[{value:"V",label:"正式(V)"}],value1:"",options2:[{value:"0",label:"0"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"13",label:"13"},{value:"14",label:"14"},{value:"15",label:"15"},{value:"16",label:"16"},{value:"17",label:"17"},{value:"18",label:"18"},{value:"19",label:"19"},{value:"20",label:"20"}],value2:"",options3:[{value:"0",label:"0"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"13",label:"13"},{value:"14",label:"14"},{value:"15",label:"15"},{value:"16",label:"16"},{value:"17",label:"17"},{value:"18",label:"18"},{value:"19",label:"19"},{value:"20",label:"20"}],value3:"",options4:[{value:"0",label:"0"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"13",label:"13"},{value:"14",label:"14"},{value:"15",label:"15"},{value:"16",label:"16"},{value:"17",label:"17"},{value:"18",label:"18"},{value:"19",label:"19"},{value:"20",label:"20"}],value4:"",value5:"",innerVersion:"",releaseDesc:"",releaseDetail:"### 主要功能  \n1.   \n2.\n3.\n\n### 使用方式  \n1.\n2.\n3.\n\n### 更新内容  \n1.   \n2. \n3. \n\n### 注意事项  \n1.   \n2. \n3. "}},components:{richEditor:r.a},mounted:function(){this.getReleaseDetail()},methods:{getReleaseDetail:function(){var e=this;return s()(i.a.mark(function t(){var a,n,l,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isAdd){t.next=10;break}return t.next=3,o.g.getVersionById(e.releaseId);case 3:a=t.sent,n=a.releaseVersion,4==(l=n.split(".")).length&&(-1!=l[0].search("N")?e.value1="N":-1!=l[0].search("V")&&(e.value1="V"),s=l[0].substring(1,l[0].length),e.value2=s,e.value3=l[1],e.value4=l[2],e.value5=l[3]),e.innerVersion=a.innerVersion,e.releaseDesc=a.releaseDesc,e.releaseDetail=a.releaseDetail;case 10:case"end":return t.stop()}},t,e)}))()},cancel:function(){var e=this;this.$modal.show(d.a,{},{draggable:".top",height:"250px",width:"520px"},{closed:function(t){!0===t&&c.b.goVersionManage(e.productId)}})},reset:function(){this.value1="",this.value2="",this.value3="",this.value4="",this.value5="",this.innerVersion="",this.releaseDesc="",this.releaseDetail=""},next:function(){this.isAdd?this.addVersion():this.$emit("onNext",this.releaseId)},submit:function(){this.updateVersion()},addVersion:function(){var e=this;return s()(i.a.mark(function t(){var a,n,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.value1&&e.value2&&e.value3&&e.value4&&e.value5){t.next=4;break}u.Message.error("请填写完整的版本号信息"),t.next=14;break;case 4:if(e.releaseDetail){t.next=8;break}u.Message.error("版本描述不能为空"),t.next=14;break;case 8:return a=e.value1+e.value2+"."+e.value3+"."+e.value4+"."+e.value5,t.next=11,o.g.addVersion({productId:e.productId,releaseVersion:a,releaseDesc:e.releaseDesc,pocEnv:"",innerVersion:e.innerVersion,releaseDetail:e.releaseDetail});case 11:n=t.sent,l=n.releaseId,e.$emit("onNext",l);case 14:case"end":return t.stop()}},t,e)}))()},updateVersion:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.value1&&e.value2&&e.value3&&e.value4&&e.value5){t.next=4;break}u.Message.error("请填写完整的版本号信息"),t.next=14;break;case 4:if(e.releaseDetail){t.next=8;break}u.Message.error("版本描述不能为空"),t.next=14;break;case 8:return a=e.value1+e.value2+"."+e.value3+"."+e.value4+"."+e.value5,t.next=11,o.g.updateVersion({releaseId:e.releaseId,releaseVersion:a,releaseDesc:e.releaseDesc,pocEnv:"",innerVersion:e.innerVersion,releaseDetail:e.releaseDetail,releaseCreator:""});case 11:t.sent,u.Message.success("修改成功"),c.b.goVersionManage(e.productId);case 14:case"end":return t.stop()}},t,e)}))()}}},v=(a("ftnC"),a("K1/g")),f=Object(v.a)(p,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"versionBasicInfoLayout"},[a("div",{staticClass:"outer_version_content"},[a("div",{staticStyle:{width:"84px"}},[e._v("对外版本号：")]),e._v(" "),a("el-select",{staticStyle:{width:"140px",height:"36px","margin-left":"24px"},attrs:{placeholder:"请选择"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-select",{staticStyle:{width:"140px",height:"36px","margin-left":"16px"},attrs:{placeholder:"主版本号",filterable:"","default-first-option":"","allow-create":""},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-select",{staticStyle:{width:"140px",height:"36px","margin-left":"16px"},attrs:{placeholder:"次版本号",filterable:"","default-first-option":"","allow-create":""},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}},e._l(e.options3,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-select",{staticStyle:{width:"140px",height:"36px","margin-left":"16px"},attrs:{placeholder:"修订版本号",filterable:"","default-first-option":"","allow-create":""},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}},e._l(e.options4,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px",height:"36px","margin-left":"16px"},attrs:{type:"date",placeholder:"年/月/日",editable:!1,"picker-options":e.pickerOptions,format:"yyyy/MM/dd","value-format":"yyyyMMdd"},model:{value:e.value5,callback:function(t){e.value5=t},expression:"value5"}})],1),e._v(" "),a("div",{staticClass:"inner_version_content"},[a("div",{staticStyle:{width:"84px"}},[e._v("内部版本号：")]),e._v(" "),a("el-input",{staticStyle:{width:"764px",height:"36px","margin-left":"24px"},attrs:{placeholder:"请输入内部版本号（选填）",maxlength:"20"},model:{value:e.innerVersion,callback:function(t){e.innerVersion=t},expression:"innerVersion"}})],1),e._v(" "),a("div",{staticClass:"user_guide_content"},[a("div",{staticStyle:{width:"84px",float:"right",display:"inline-block"}},[e._v("引用方法：")]),e._v(" "),a("el-input",{staticStyle:{width:"764px",height:"124px","margin-left":"24px"},attrs:{placeholder:"请输入该版本号的引用方法（选填）",type:"textarea",rows:"5"},model:{value:e.releaseDesc,callback:function(t){e.releaseDesc=t},expression:"releaseDesc"}})],1),e._v(" "),e._m(0),e._v(" "),a("div",{staticStyle:{height:"100%",width:"100%","margin-top":"20px"}},[a("richEditor",{staticClass:"markdownPad",attrs:{mode:"edit"},model:{value:e.releaseDetail,callback:function(t){e.releaseDetail=t},expression:"releaseDetail"}})],1),e._v(" "),a("div",{staticClass:"button_area"},[a("el-button",{attrs:{round:""},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isAdd,expression:"isAdd"}],attrs:{round:""},on:{click:e.reset}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{round:"",type:e.isAdd?"primary":"plain"},on:{click:e.next}},[e._v(e._s(e.isAdd?" 完善附件信息 ":"修改附件信息"))]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isAdd,expression:"!isAdd"}],attrs:{round:"",type:"primary"},on:{click:e.submit}},[e._v(" 提交 ")])],1)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{width:"84px","font-size":"16px","margin-top":"20px"}},[t("b",[this._v("版本描述")])])}],!1,null,"fc2745ee",null).exports,b=a("XOvE"),m=a("yqLs"),x=a("NHnr"),h={mixins:[m.a],props:{attachmentId:{},attachmentName:"",attachmentDesc:"",attachmentUrl:"",isEdit:{}},data:function(){return{input_name:"",input_des:"",file:"",fileName:""}},components:{modaltemplate2:b.a},mounted:function(){this.input_name=this.attachmentName,this.input_des=this.attachmentDesc},methods:{selectFile:function(){var e=this;return s()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.b.selectFiles();case 2:e.file=t.sent,e.fileName=e.file.name;case 4:case"end":return t.stop()}},t,e)}))()},cancel:function(){this.$closeModal()},confirm:function(){this.input_name?this.input_des?this.file||this.isEdit?(console.log("eventbus emit: uploadFile"),x.eventHub.$emit("uploadFile",{attachmentId:this.attachmentId,attachmentName:this.input_name,attachmentDesc:this.input_des,attachmentUrl:this.attachmentUrl,isEdit:this.isEdit,file:this.file,time:Date.parse(new Date)}),this.$closeModal()):u.Message.error("请选择需要上传的文件"):u.Message.error("附件描述不能为空"):u.Message.error("附件名称不能为空")}}},g=(a("V8/E"),Object(v.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modaltemplate2",{scopedSlots:e._u([{key:"top",fn:function(){return[a("div",{staticClass:"top_area"},[e._v("附件上传")])]},proxy:!0},{key:"main",fn:function(){return[a("div",{staticClass:"main_area"},[a("div",{staticClass:"nameColumn"},[a("div",[e._v("附件名称：")]),e._v(" "),a("el-input",{staticStyle:{width:"374px"},attrs:{placeholder:"请输入附件名称",size:"small",maxlength:"20"},model:{value:e.input_name,callback:function(t){e.input_name=t},expression:"input_name"}})],1),e._v(" "),a("div",{staticClass:"descColumn"},[a("div",[e._v("附件描述：")]),e._v(" "),a("el-input",{staticStyle:{width:"374px"},attrs:{placeholder:"请输入附件描述",size:"small",maxlength:"50"},model:{value:e.input_des,callback:function(t){e.input_des=t},expression:"input_des"}})],1),e._v(" "),a("div",{staticClass:"fileColumn"},[a("div",[e._v("附件上传：")]),e._v(" "),a("el-button",{attrs:{plain:"",size:"small"},on:{click:e.selectFile}},[a("i",{staticClass:"el-icon-upload2"}),e._v("\n                    选择文件\n                ")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.fileName,expression:"fileName"}],staticClass:"fileNameColumn"},[a("i",{staticClass:"el-icon-paperclip",staticStyle:{"margin-right":"5px"}}),e._v(" "),a("div",[e._v(e._s(e.fileName))])])])]},proxy:!0},{key:"bottom",fn:function(){return[a("div",{staticClass:"bottom_area"},[a("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)]},proxy:!0}])})},[],!1,null,"08dca417",null).exports),w=a("d63C"),y={mixins:[m.a],props:{productId:{type:String|Number},resultTitle:{type:String},resultMsg:{type:String}},data:function(){return{}},components:{modaltemplate2:b.a},methods:{waitPermission:function(){c.b.goVersionManage(this.productId),this.$closeModal()},goPermission:function(){c.b.goManagePermission(this.productId,!1),this.$closeModal()}}},_=(a("zgP4"),Object(v.a)(y,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modaltemplate2",{scopedSlots:e._u([{key:"top",fn:function(){return[a("div",{staticClass:"top_area"},[e._v("提交结果")])]},proxy:!0},{key:"main",fn:function(){return[a("div",{staticClass:"main_area"},[a("i",{staticClass:"el-icon-success",staticStyle:{"font-size":"72px",color:"rgba(103, 218, 193, 1)"}}),e._v(" "),a("div",{staticClass:"title1"},[a("b",[e._v(e._s(e.resultTitle))])]),e._v(" "),a("div",{staticClass:"title2"},[e._v(e._s(e.resultMsg))])])]},proxy:!0},{key:"bottom",fn:function(){return[a("div",{staticClass:"bottom_area"},[a("el-button",{staticClass:"btn_wait_permission",attrs:{round:""},on:{click:e.waitPermission}},[e._v(" 暂不处理 ")]),e._v(" "),a("el-button",{attrs:{round:"",type:"primary"},on:{click:e.goPermission}},[e._v("新增授权")])],1),e._v("·\n    ")]},proxy:!0}])})},[],!1,null,"cbaa47ba",null).exports),k={components:{nodata:w.a},props:{productId:{},releaseId:{}},data:function(){return{netTableData:[],addTableData:[],loading:!1,uploadingIds:[]}},computed:{isTopButtonShow:function(){return!(this.tableData.length<1)},isInitButtonShow:function(){return this.tableData.length<1},tableData:function(){return this.addTableData.concat(this.netTableData)}},created:function(){this.onEventBus()},mounted:function(){this.searchAppendList()},beforeDestroy:function(){this.destroyEventBus(),this.uploadingIds=[]},methods:{submit:function(){var e=this;return s()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.c.queryAuthorizeForProduct_download(e.productId);case 2:t.sent.length>0?(e.$message({type:"success",message:"版本提交成功"}),c.b.goVersionManage(e.productId)):e.$modal.show(_,{productId:e.productId,resultTitle:"版本提交成功",resultMsg:"您尚未授权，点击新增授权去授权页面"},{draggable:".top",height:"413px",width:"538px"});case 4:case"end":return t.stop()}},t,e)}))()},searchAppendList:function(){var e=this;return s()(i.a.mark(function t(){var a,n,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.releaseId){t.next=13;break}return t.prev=1,e.loading=!0,a={pageSize:999,pageNum:1},t.next=6,o.b.getListByReleaseId(a,e.releaseId);case 6:n=t.sent,(l=n.datas).forEach(function(e){e.percent="100%（上传完成）"}),e.netTableData=l;case 10:return t.prev=10,e.loading=!1,t.finish(10);case 13:case"end":return t.stop()}},t,e,[[1,,10,13]])}))()},destroyEventBus:function(){x.eventHub.$off("uploadFile")},onEventBus:function(){var e=this;x.eventHub.$off("uploadFile"),x.eventHub.$on("uploadFile",function(t){console.log("onBusEvent: uploadFile");var a=t.attachmentId,n=t.attachmentName,i=t.attachmentDesc,l=t.attachmentUrl,s=t.isEdit,r=t.file,o=(t.time,e);!s&&r?o.addFileToUploadList(n,i,r,Date.parse(new Date)):s&&r?o.editFileToUploadList(n,i,r,a,Date.parse(new Date)):s&&l&&o.editAttachment(a,n,i,l)})},addFileToUploadList:function(e,t,a,n){var l=this;return s()(i.a.mark(function s(){var r,c;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.b.acquire(l.productId,2);case 2:r=i.sent,o.a.initKs3(r.accessKeyId,r.secretAccessKey,r.expiration),c={attachmentName:e,attachmentDesc:t,releaseId:l.releaseId,percent:"0%（未开始）",uploadingId:n},l.addTableData.push(c),l.uploadingIds.push(n),o.a.uploadFile(l.productId,l.releaseId,a,function(e){-1!=l.uploadingIds.indexOf(n)&&l.addTableData.forEach(function(t){t.uploadingId===n&&(t.percent=e+"%（上传中）")})},function(e){if(console.log("上传过程发生错误"),console.log(e),-1!=l.uploadingIds.indexOf(n)){for(var t=-1,a=0;a<l.addTableData.length;a++)if(l.addTableData[a].uploadingId==n){t=a;break}t>=0&&l.addTableData.splice(t,1)}},function(a){if(console.log("上传完成，url： "+a),-1!=l.uploadingIds.indexOf(n)){for(var i=-1,s=0;s<l.addTableData.length;s++)if(l.addTableData[s].uploadingId==n){i=s;break}i>=0&&l.addTableData.splice(i,1),l.addAttachment(e,t,a)}});case 8:case"end":return i.stop()}},s,l)}))()},editFileToUploadList:function(e,t,a,n,l){var r=this;return s()(i.a.mark(function s(){var c,u,d;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.b.acquire(r.productId,2);case 2:c=i.sent,o.a.initKs3(c.accessKeyId,c.secretAccessKey,c.expiration),u=void 0,d=0;case 6:if(!(d<r.netTableData.length)){i.next=13;break}if(r.netTableData[d].attachmentId!=n){i.next=10;break}return u=r.netTableData[d],i.abrupt("break",13);case 10:d++,i.next=6;break;case 13:u.attachmentName=e,u.attachmentDesc=t,u.uploadingId=l,r.uploadingIds.push(l),o.a.uploadFile(r.productId,r.releaseId,a,function(e){-1!=r.uploadingIds.indexOf(l)&&(u.percent=e+"%（上传中）")},function(a){console.log("上传过程发生错误"),console.log(a),-1!=r.uploadingIds.indexOf(l)&&r.editAttachment(n,e,t,attachmentUrl)},function(a){console.log("上传完成，url： "+a),-1!=r.uploadingIds.indexOf(l)&&r.editAttachment(n,e,t,a)});case 18:case"end":return i.stop()}},s,r)}))()},addAppend:function(){var e=this;return s()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e,e.$modal.show(g,{isEdit:!1},{draggable:".top",height:"317px",width:"538px"});case 2:case"end":return t.stop()}},t,e)}))()},edit:function(e){var t=this;return s()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t,t.$modal.show(g,{attachmentId:e.attachmentId,attachmentName:e.attachmentName,attachmentDesc:e.attachmentDesc,attachmentUrl:e.attachmentUrl,isEdit:!0},{draggable:".top",height:"317px",width:"520px"});case 2:case"end":return a.stop()}},a,t)}))()},addAttachment:function(e,t,a){var n=this;return s()(i.a.mark(function l(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.b.addAttachment(n.releaseId,e,t,a);case 2:i.sent,u.Message.success("添加成功"),n.searchAppendList();case 5:case"end":return i.stop()}},l,n)}))()},editAttachment:function(e,t,a,n){var l=this;return s()(i.a.mark(function s(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.b.editAttachment(e,l.releaseId,t,a,n);case 2:i.sent,u.Message.success("修改成功"),l.searchAppendList();case 5:case"end":return i.stop()}},s,l)}))()},del:function(e){var t=this;return s()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.b.deleteById(e.attachmentId);case 2:a.sent,t.searchAppendList();case 4:case"end":return a.stop()}},a,t)}))()}}},I=(a("WiDU"),{components:{basicInfo:f,appendInfo:Object(v.a)(k,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"appendLayout"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isTopButtonShow,expression:"isTopButtonShow"}]},[a("el-button",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"primary",round:""},on:{click:e.addAppend}},[e._v("添加附件")]),e._v(" "),a("el-button",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"primary",round:""},on:{click:e.submit}},[e._v("  提交  ")])],1),e._v(" "),a("div",{staticStyle:{color:"#FF6F80"}},[e._v("温馨提示：上传附件进度未全部100%时，请勿关闭浏览器！关闭会造成附件上传失败")]),e._v(" "),a("nodata",{attrs:{data:e.tableData,tips:"请进行，版本号附件上传",loading:e.loading}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"附件名称",prop:"attachmentName",width:"240px"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"附件描述",prop:"attachmentDesc","min-width":"300px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",{staticStyle:{width:"540px","max-height":"70px","white-space":"normal",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"2",overflow:"hidden","text-overflow":"ellipsis"}},[e._v(e._s(n.attachmentDesc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"上传时间",prop:"createTime",width:"280px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e._f("datetimeformat")(n.createTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"上传进度",prop:"percent",width:"280px"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!n.uploading,expression:"!row.uploading"}],staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"},on:{click:function(t){return e.edit(n)}}},[e._v("修改")]),e._v(" "),n.uploading?e._e():a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("confirm-button",{directives:[{name:"show",rawName:"v-show",value:!n.uploading,expression:"!row.uploading"}],attrs:{popOption:{content:"确认要删除附件？"},confirmCallback:function(){e.del(n)}}},[a("el-button",{staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"}},[e._v("删除")])],1)]}}])})],1)],1),e._v(" "),a("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isInitButtonShow,expression:"isInitButtonShow"}],attrs:{type:"primary",round:""},on:{click:e.addAppend}},[e._v(" 添加附件 ")])],1)],1)},[],!1,null,"7fd41c9d",null).exports},data:function(){return{active:"first",productId:"",releaseId:"",isAdd:!1}},computed:{productIdFromRouter:function(){return this.$route.query.productId},releaseIdFromRouter:function(){return this.$route.query.releaseId},isAddFromRouter:function(){return!this.$route.query.releaseId},disable_first:function(){return!1},disable_second:function(){return!!this.isAdd&&"first"===this.active}},created:function(){this.init()},methods:{onBasicNext:function(e){this.releaseId=e,this.active="second",this.isAdd=!1},init:function(){this.productId=this.productIdFromRouter,this.releaseId=this.releaseIdFromRouter,this.isAdd=this.isAddFromRouter}}}),D=(a("3Khx"),Object(v.a)(I,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"productVersionEditLayout"},[a("el-tabs",{model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[a("el-tab-pane",{staticStyle:{overflow:"auto"},attrs:{label:"版本信息",name:"first",disabled:e.disable_first}},[a("basicInfo",{attrs:{productId:e.productId,releaseId:e.releaseId,isAdd:e.isAdd},on:{onNext:e.onBasicNext,"update:releaseId":function(t){e.releaseId=t},"update:release-id":function(t){e.releaseId=t},"update:isAdd":function(t){e.isAdd=t},"update:is-add":function(t){e.isAdd=t}}})],1),e._v(" "),a("el-tab-pane",{staticStyle:{overflow:"auto"},attrs:{label:"附件信息",name:"second",disabled:e.disable_second}},[a("appendInfo",{attrs:{productId:e.productId,releaseId:e.releaseId},on:{"update:releaseId":function(t){e.releaseId=t},"update:release-id":function(t){e.releaseId=t}}})],1)],1)],1)},[],!1,null,"a80b29f4",null));t.default=D.exports},sriz:function(e,t,a){var n=a("BDhp");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("f035109c",n,!0)},tgZC:function(e,t,a){var n=a("w7nm");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("824f9d12",n,!0)},w7nm:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".productVersionEditLayout[data-v-a80b29f4] {\n  width: 100%;\n  height: 100%;\n  padding: 24px 48px 24px 48px;\n}\n",""])},zgP4:function(e,t,a){"use strict";var n=a("6Azs");a.n(n).a}});