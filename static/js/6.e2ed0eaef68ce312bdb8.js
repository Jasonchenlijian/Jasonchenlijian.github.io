webpackJsonp([6],{"/Aru":function(t,e,n){var a=n("8ni9");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("f7962c4c",a,!0)},"2wAC":function(t,e,n){"use strict";var a=n("qu44");n.n(a).a},"8ni9":function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,".top_area[data-v-61d61c68] {\n  font-size: 16px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-left: 24px;\n  color: #363c46;\n}\n.main_area[data-v-61d61c68] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-top: 30px;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.main_area .title[data-v-61d61c68] {\n    font-size: 20px;\n    height: 32px;\n}\n.main_area .edit[data-v-61d61c68] {\n    width: 90%;\n    margin: 20px auto auto auto;\n}\n.bottom_area[data-v-61d61c68] {\n  width: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  margin-top: -60px;\n}\n",""])},d6hy:function(t,e,n){"use strict";var a=n("XOvE"),r=n("yqLs"),o=(n("ilaD"),n("zL8q")),i={mixins:[r.a],props:{title:{type:String},editHint:{type:String},tips:{type:String}},data:function(){return{remark:""}},components:{modaltemplate2:a.a},methods:{close:function(){this.$closeModal()},confirm:function(){this.remark?this.$closeModal(this.remark):o.Message.error("请先填写内容")},cancel:function(){this.$closeModal()}}},s=(n("mCmT"),n("K1/g")),l=Object(s.a)(i,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("modaltemplate2",{scopedSlots:t._u([{key:"top",fn:function(){return[n("div",{staticClass:"top_area"},[t._v("提示")])]},proxy:!0},{key:"main",fn:function(){return[n("div",{staticClass:"main_area"},[n("div",{staticClass:"title"},[n("b",[t._v(t._s(t.title))])]),t._v(" "),n("el-input",{staticClass:"edit",attrs:{type:"textarea",rows:5,placeholder:t.editHint,maxlength:"500"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"bottom_area"},[n("el-button",{staticStyle:{"margin-right":"50px"},attrs:{round:""},on:{click:t.cancel}},[t._v(" 取消 ")]),t._v(" "),n("el-button",{attrs:{round:"",type:"primary"},on:{click:t.confirm}},[t._v(" 确定 ")])],1),t._v("·\n    ")]},proxy:!0}])})},[],!1,null,"61d61c68",null);e.a=l.exports},ffDo:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Xxa5"),r=n.n(a),o=n("exGp"),i=n.n(o),s=n("0jG4"),l=n("ilaD"),c=n("zL8q"),u=n("d63C"),p=n("d6hy"),d={components:{nodata:u.a},data:function(){return{tableInfo:{table:{pageSizes:[10,20,30,50],tableData:[],totalSize:0,loading:!1},paging:{pageSize:10,pageNum:1}},productList:[],selectProduct:"",status:""}},computed:{productIdFromRouter:function(){return this.$route.query.productId},delBtnShow:function(){return 1!=this.selectProduct.status||this.tableInfo.table.totalSize>1},isTopButtonShow:function(){return!!this.selectProduct&&!(this.tableInfo.table.tableData.length<1)},isInitButtonShow:function(){return!!this.selectProduct&&this.tableInfo.table.tableData.length<1},noDataTip:function(){return this.selectProduct?this.tableInfo.table.tableData.length<1?"该资产名称，还没有添加过版本信息":"":"需要有资产名称，版本信息才会显示哟"}},mounted:function(){this.init()},filters:{statusFromat:function(t){switch(t){case 1:return"已发布";case 2:return"待发布";case 3:return"审核中";case 4:return"审核不通过"}}},methods:{init:function(){var t=this;return i()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.searchCBB();case 1:case"end":return e.stop()}},e,t)}))()},filterStatus:function(t,e){return e.status===t},searchCBB:function(){var t=this;return i()(r.a.mark(function e(){var n,a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={pageSize:999,pageNum:1},e.next=3,s.g.getCurrentUserList(n,"");case 3:if(a=e.sent,t.productList=a.list,!t.productIdFromRouter){e.next=15;break}o=0;case 7:if(!(o<t.productList.length)){e.next=15;break}if(t.productList[o].productId!==t.productIdFromRouter){e.next=12;break}return t.selectProduct=t.productList[o],t.searchVersionList(),e.abrupt("break",15);case 12:o++,e.next=7;break;case 15:case"end":return e.stop()}},e,t)}))()},searchVersionList:function(){var t=this;return i()(r.a.mark(function e(){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.selectProduct){e.next=14;break}return e.prev=1,t.tableInfo.table.loading=!0,e.next=5,s.g.getMyVersionListByProductId(t.tableInfo.paging,t.selectProduct.productId,t.status);case 5:n=e.sent,console.log(n),t.tableInfo.table.tableData=n.list,t.tableInfo.paging.pageNum=n.paging.pageNum,t.tableInfo.paging.pageSize=n.paging.pageSize,t.tableInfo.table.totalSize=n.paging.dataCount;case 11:return e.prev=11,t.tableInfo.table.loading=!1,e.finish(11);case 14:case"end":return e.stop()}},e,t,[[1,,11,14]])}))()},addVersion:function(){this.selectProduct?l.b.goVersionManageDetail(this.selectProduct.productId,""):c.Message.error("请先选择资产")},edit:function(t){l.b.goVersionManageDetail(this.selectProduct.productId,t.releaseId)},up:function(t){var e=this;return i()(r.a.mark(function n(){var a;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=window.location.protocol+"//"+window.location.host+"/#/simpleLayout/audit?productId="+t.productId+"&tab=2",console.log("url",a),n.next=4,s.g.activeVersion({releaseId:t.releaseId,productDetailsUrl:a});case 4:n.sent,e.searchVersionList();case 6:case"end":return n.stop()}},n,e)}))()},down:function(t,e){var n=this;return i()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.g.invalidVersion({releaseId:t.releaseId,remark:e});case 2:a.sent,n.searchVersionList();case 4:case"end":return a.stop()}},a,n)}))()},processCancel:function(t){var e=this;return i()(r.a.mark(function n(){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.g.cancelVersion({releaseId:t.releaseId});case 2:n.sent,e.searchVersionList();case 4:case"end":return n.stop()}},n,e)}))()},del:function(t){var e=this;return i()(r.a.mark(function n(){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.g.delVersion({releaseId:t.releaseId});case 2:n.sent,e.searchVersionList();case 4:case"end":return n.stop()}},n,e)}))()},sizeChange:function(t){this.tableInfo.paging.pageSize=t,this.searchVersionList()},pageChange:function(t){this.tableInfo.paging.pageNum=t,this.searchVersionList()},selectChange:function(t){this.status="",this.searchVersionList()},downOptionDialog:function(t){var e=this;this.$modal.show(p.a,{title:"撤回原因",editHint:"请详细描述具体的撤回原因",tips:"申请成功后需经过撤回审核流程，审通过自动撤回"},{draggable:".top",height:"413px",width:"538px"},{closed:function(n){n&&e.down(t,n)}})}}},f=(n("2wAC"),n("K1/g")),b=Object(f.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"productManagePage"},[n("div",{staticClass:"searchArea"},[n("div",{staticStyle:{display:"flex","align-items":"center","magin-right":"8px"}},[t._v("资产名称：")]),t._v(" "),n("el-select",{staticStyle:{width:"374px",height:"36px"},attrs:{"value-key":"productName",filterable:"",placeholder:"请选择资产名称"},on:{change:t.selectChange},model:{value:t.selectProduct,callback:function(e){t.selectProduct=e},expression:"selectProduct"}},t._l(t.productList,function(t){return n("el-option",{key:t.value,attrs:{label:t.productName,value:t}})}),1)],1),t._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isTopButtonShow,expression:"isTopButtonShow"}],staticStyle:{"margin-bottom":"24px"},attrs:{type:"primary",round:""},on:{click:t.addVersion}},[t._v("新增版本号")]),t._v(" "),n("nodata",{attrs:{data:t.tableInfo.table.tableData,tips:t.noDataTip,loading:t.tableInfo.table.loading}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableInfo.table.loading,expression:"tableInfo.table.loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableInfo.table.tableData,"default-sort":{prop:"updateTime",order:"descending"}}},[n("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"版本号",prop:"releaseVersion",width:"240px"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("div",[n("div",{staticStyle:{"text-overflow":"ellipsis"}},[n("span",[t._v("对内：")]),t._v(" "),n("span",[t._v(t._s(a.innerVersion))])]),t._v(" "),n("div",{staticStyle:{"text-overflow":"ellipsis"}},[n("span",[t._v("对外：")]),t._v(" "),n("span",[t._v(t._s(a.releaseVersion))])])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"版本号描述",prop:"releaseDesc","min-width":"420px"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("div",{staticStyle:{width:"400px","max-height":"70px","white-space":"normal",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"2",overflow:"hidden","text-overflow":"ellipsis"}},[t._v(t._s(a.releaseDesc))])]}}])}),t._v(" "),n("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"版本状态",prop:"status",width:"150px",filters:[{text:"已发布",value:1},{text:"待发布",value:2},{text:"审核中",value:3},{text:"审核不通过",value:4}],"filter-method":t.filterStatus,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(t._f("statusFromat")(a.status)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"发布者",prop:"releaseCreatorName",width:"150px"}}),t._v(" "),n("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"发布时间",prop:"updateTime",width:"280px",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(t._f("datetimeformat")(a.createTime)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",prop:"handle",width:"260px"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[2==a.status||4==a.status?n("el-button",{staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"},on:{click:function(e){return t.edit(a)}}},[t._v("修改")]):t._e(),t._v(" "),2==a.status||4==a.status?n("el-divider",{attrs:{direction:"vertical"}}):t._e(),t._v(" "),2==a.status||4==a.status?n("confirm-button",{attrs:{popOption:{content:"确认要发布该版本号？\n发布后，用户将可以使用该版本信息"},confirmCallback:function(){t.up(a)}}},[n("el-button",{staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"}},[t._v("发布申请")])],1):t._e(),t._v(" "),2==a.status||4==a.status&&t.delBtnShow?n("el-divider",{attrs:{direction:"vertical"}}):t._e(),t._v(" "),1!=a.status&&3!=a.status?n("confirm-button",{attrs:{popOption:{content:"确认要删除版本？"},confirmCallback:function(){t.del(a)}}},[n("el-button",{staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"}},[t._v("删除")])],1):t._e(),t._v(" "),1==a.status?n("confirm-button",{attrs:{popOption:{content:"确认要撤回该版本号？\n撤回后，用户将无法看到该版本号"},confirmCallback:function(){t.downOptionDialog(a)}}},[n("el-button",{staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"}},[t._v("撤回")])],1):t._e(),t._v(" "),3==a.status?n("confirm-button",{attrs:{popOption:{content:"确认要取消该版本审核？\n取消后，再次发布需重新走审核流程"},confirmCallback:function(){t.processCancel(a)}}},[n("el-button",{staticStyle:{color:"rgba(51, 153, 255, 1)"},attrs:{type:"text"}},[t._v("取消申请")])],1):t._e()]}}])})],1),t._v(" "),n("el-pagination",{staticClass:"bottom-pagination",attrs:{background:"","current-page":t.tableInfo.paging.pageNum,"page-sizes":[10,20,30,50],"page-size":t.tableInfo.paging.pageSize,layout:"total, prev, pager, next, sizes,jumper",total:t.tableInfo.table.totalSize},on:{"size-change":t.sizeChange,"current-change":t.pageChange}})],1),t._v(" "),n("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isInitButtonShow,expression:"isInitButtonShow"}],attrs:{type:"primary",round:""},on:{click:t.addVersion}},[t._v(" 我来添加 ")])],1)],1)},[],!1,null,"1c72c75f",null);e.default=b.exports},mCmT:function(t,e,n){"use strict";var a=n("/Aru");n.n(a).a},qu44:function(t,e,n){var a=n("tJgT");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("1ada1cab",a,!0)},tJgT:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,".productManagePage[data-v-1c72c75f] {\n  padding: 24px 48px 24px 48px;\n  height: 100%;\n  width: 100%;\n}\n.productManagePage .searchArea[data-v-1c72c75f] {\n    margin-top: 0px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    margin-bottom: 36px;\n}\n.productManagePage .searchArea .checkGroup_cbb_status[data-v-1c72c75f] {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      margin-left: 34px;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n}\n.productManagePage .searchArea .checkGroup_cbb_status .checkGroup_title[data-v-1c72c75f] {\n        font-size: 14px;\n        margin-right: 10px;\n        width: 71px;\n}\n.productManagePage .status_drop[data-v-1c72c75f] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: start;\n        -ms-flex-pack: start;\n            justify-content: flex-start;\n    color: #363c46;\n    font-size: 14px;\n}\n.productManagePage .bottom-pagination[data-v-1c72c75f] {\n    text-align: center;\n    margin: 10px 0 20px 0;\n    height: 60px;\n}\n",""])}});